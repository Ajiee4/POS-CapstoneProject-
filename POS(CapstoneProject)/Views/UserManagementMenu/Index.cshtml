
@{
    Layout = "/Views/Shared/_ManagerLayout.cshtml";
}
<style>
    .link-usermanagement {
        background-color: #C6976C !important;
    }

</style>

<div class="user-wrapper">
    <button type="button" class="addUserBtn" data-toggle="modal" data-target="#addUserModal">Add User</button>

    <table class="user-table">

        <thead>
            <tr>
                <th>ID</th>
                <th>Role</th>
                <th>First Name</th>
                <th>Last Name</th>
               
                <th>Actions</th>


            </tr>

        </thead>

        <tbody>


            @foreach (var item in ViewData["UserList"] as List<UserDetail>)
                {
                    @if(!(item.User.Role.RoleName == "Manager"))
                    {
                        <tr>
                            <td>@item.UserId</td>
                            <td>@item.User.Role.RoleName</td>
                            <td>@item.Firstname</td>
                            <td>@item.Lastname</td>
                            

                            @if (@item.User.isActive)
                            {
                                <td>
                                    <div class="action-wrapper">
                                        <form asp-action="ArchiveUser" class="archiveUserForm">
                                            <input name="userid" class="inputArchiveUserId"  hidden/>
                                        </form>
                                        <button class="btn detailsUserBtn" onclick="ViewDetails('@item.EmailAddress', '@item.ContactNumber','@item.User.Username','@item.User.Password')" data-toggle="modal" data-target="#detailsUserModal">Details</button>
                                        <button class="btn archiveUserBtn" onclick="ArchiveUser(@item.UserId)">Archive</button>
                                        <button class="btn updateUserBtn" data-toggle="modal" data-target="#updateUserModal" onclick="updateUser(@item.UserId,'@item.Firstname','@item.Lastname','@item.EmailAddress','@item.ContactNumber', '@item.User.Username', '@item.User.Password',@item.User.RoleId)">Update</button>
                                    </div>
                                </td>
                            }
                            else
                            {
                                <td>
                                    <div class="action-wrapper">
                                        <form asp-action="UnarchiveUser" class="unarchiveUserForm">
                                            <input name="userid" class="inputUnrchiveUserId" hidden />
                                        </form>
                                         <button class="btn detailsUserBtn" onclick="ViewDetails('@item.EmailAddress', '@item.ContactNumber','@item.User.Username','@item.User.Password')" data-toggle="modal" data-target="#detailsUserModal">Details</button>
                                        <button class="btn unarchiveUserBtn" onclick="UnarchiveUser(@item.UserId)" >Unarchive</button>
                                        <button class="btn updateUserBtn" data-toggle="modal" data-target="#updateUserModal" onclick="updateUser(@item.UserId,'@item.Firstname','@item.Lastname','@item.EmailAddress','@item.ContactNumber', '@item.User.Username', '@item.User.Password',@item.User.RoleId)">Update</button>
                                    </div>
                                </td>
                            }

                        </tr>
                    }
              
                }
            
        </tbody>


    </table>


</div>


<!--Add New User-->

<div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ADD USER</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form asp-action="AddUser" id="addUserForm" method="post">
                    <div class="row">
                        <div class="col-md-6">                        
                            <label class="control-label">First Name</label>
                            <input class="form-control inputFirstName" name="firstname" placeholder="Enter First Name" type="text" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Last Name</label>
                            <input class="form-control inputLastName" name="lastname" placeholder="Enter Last Name" type="text" required />
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Email</label>
                            <input class="form-control inputEmail" name="email" placeholder="Enter Email Address" type="email" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Cellphone No.</label>
                            <input class="form-control inputCellphone" name="cellnumber" placeholder="Enter Cellphone Number" type="text" required />
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Username</label>
                            <input class="form-control inputUsername" name="username" placeholder="Enter Username" type="text" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Password</label>
                            <input class="form-control inputPassword" name="password"  placeholder="Enter Password" type="password" required />
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Role</label><br />
                            <select name="roleId" class="selectRole">
                                @foreach (var item in ViewData["RoleList"] as List<Role>)
                                {

                                    <option value="@item.RoleId">@item.RoleName</option>
                                }
                            </select>
                        </div>
                    </div>
                                     
                    <br />
                    <div class="form-group">
                        <button type="button" class="d-block mx-auto addUserSubmit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Update New User-->

<div class="modal fade" id="updateUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">UPDATE USER</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form asp-action="UpdateUser" id="updateUserForm" method="post">

                    <input class="inputUserId" name="userid" hidden />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">First Name</label>
                            <input class="form-control inputFirstName" name="firstname" placeholder="Enter First Name" type="text" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Last Name</label>
                            <input class="form-control inputLastName" name="lastname" placeholder="Enter Last Name" type="text" required />
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Email</label>
                            <input class="form-control inputEmail" name="email" placeholder="Enter Email Address" type="email" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Cellphone No.</label>
                            <input class="form-control inputCellphone" name="cellnumber" placeholder="Enter Cellphone Number" type="text" required />
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Username</label>
                            <input class="form-control inputUsername" name="username" placeholder="Enter Username" type="text" required />
                        </div>

                        <div class="col-md-6">
                            <label class="control-label">Password</label>
                            <input class="form-control inputPassword" name="password" placeholder="Enter Password" type="password" required />
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Role</label><br />
                            <select name="roleId" class="selectRole">
                                @foreach (var item in ViewData["RoleList"] as List<Role>)
                                {

                                    <option value="@item.RoleId">@item.RoleName</option>
                                }
                            </select>
                        </div>
                    </div>

                    <br />
                    <div class="form-group">
                        <button type="button" class="d-block mx-auto updateUserSubmit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="detailsUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">USER DETAILS</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">              
                     <div class="details-wrapper">

                         <table class="details-table">
                                 <tr>
                                     <th>Email</th>
                                     <td class="email"></td>
                                 </tr>

                                <tr>
                                    <th>Cellphone Number</th>
                                    <td class="cellphone"></td>
                                </tr>

                                <tr>
                                    <th>Username</th>
                                    <td class="username"></td>
                                </tr>

                                <tr>
                                    <th>Password</th>
                                    <td class="password"></td>
                                </tr>
                         </table>
                           
                     </div>                                             
                <br />
                <br />
                <div class="form-group">
                    <button type="button" data-dismiss="modal" class="d-block mx-auto detailUserBack">Back</button>
                </div>
            </div>
        </div>
    </div>
</div>


@if (TempData["SuccessArchived"] != null)
{
    <script>
        Swal.fire({
            text: "Product Archived",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}
@if (TempData["SuccessUnarchived"] != null)
{
    <script>
        Swal.fire({
            text: "Product Unarchived",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}

@if (TempData["AddUser"] != null)
{
    <script>
        Swal.fire({
            text: "User Added",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}
@if (TempData["UpdateUser"] != null)
{
    <script>
        Swal.fire({
            text: "User Updated",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });
    </script>

}
@if (TempData["Exist"] != null)
{
    <script>
        Swal.fire({
            text: "Username already exist",
            icon: "error",
            showConfirmButton: false,
            timer: 2000
        });
    </script>

}