
@{
    Layout = "/Views/Shared/_ManagerLayout.cshtml";
    var userList = ViewData["UserList"] as List<UserDetail>;
}
<style>
    .link-usermanagement {
        background-color: #747474 !important;
    }
</style>

<div class="loader-wrapper">
    <div class="loader"></div>
</div>

<div class="user-wrapper">
    <button type="button" class="addUserBtn general-button" data-toggle="modal" data-target="#addUserModal">
        <img src="~/images/add.png" />
        <span>Add User</span>
    </button>

    <table class="user-table general-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Role</th>
                <th>First Name</th>
                <th>Last Name</th>              
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (userList == null)
            {
             
            }
            else
            {
                @foreach (var item in userList)
                {
                    @if ((item.User?.Role?.RoleName != "Manager"))
                    {
                        <tr class="@(item.User.isActive == true ? "" :"archived-user")">
                            <td data-label="ID">@item.UserId</td>
                            <td data-label="Role">@item.User?.Role?.RoleName</td>
                            <td data-label="First Name">@item.Firstname</td>
                            <td data-label="Last Name">@item.Lastname</td>
                            @if (@item.User?.isActive  == true)
                            {
                                <td data-label="Actions">
                                    <div class="action-wrapper">
                                        <form asp-action="ArchiveUser" class="archiveUserForm">
                                            <input name="userid" class="inputArchiveUserId" hidden />
                                        </form>
                                        <button class="btn detailsUserBtn general-details-btn" data-placement="bottom" title="Details" onclick="ViewDetails('@item.EmailAddress', '@item.ContactNumber','@item.User.Username','@item.User.Password')" data-toggle="modal" data-target="#detailsUserModal">
                                            <img src="~/images/details.png" />
                                        </button>
                                        <button class="btn archiveUserBtn general-archive-btn" data-toggle="tooltip" data-placement="bottom" title="Archive" onclick="ArchiveUser(@item.UserId)">
                                            <img src="~/images/inbox.png" />
                                        </button>
                                        <button class="btn updateUserBtn general-update-btn" data-placement="bottom" title="Update" data-toggle="modal" data-target="#updateUserModal" onclick="updateUser(@item.UserId,'@item.Firstname','@item.Lastname','@item.EmailAddress','@item.ContactNumber', '@item.User.Username', '@item.User.Password')">
                                            <img src="~/images/edit.png" />
                                        </button>
                                    </div>
                                </td>
                            }
                            else
                            {
                                <td data-label="Actions">
                                    <div class="action-wrapper">
                                        <form asp-action="UnarchiveUser" class="unarchiveUserForm">
                                            <input name="userid" class="inputUnrchiveUserId" hidden />
                                        </form>

                                        <button class="btn detailsUserBtn general-details-btn" data-placement="bottom" title="Details" onclick="ViewDetails('@item.EmailAddress', '@item.ContactNumber','@item.User?.Username','@item.User?.Password')" data-toggle="modal" data-target="#detailsUserModal">
                                            <img src="~/images/details.png" />
                                        </button>
                                        <button class="btn unarchiveUserBtn general-unarchive-btn" data-toggle="tooltip" data-placement="bottom" title="Unarchive" onclick="UnarchiveUser(@item.UserId)">
                                            <img src="~/images/outbox.png" />
                                        </button>
                                        <button class="btn updateUserBtn general-update-btn" data-placement="bottom" title="Update" data-toggle="modal" data-target="#updateUserModal" onclick="updateUser(@item.UserId,'@item.Firstname','@item.Lastname','@item.EmailAddress','@item.ContactNumber', '@item.User?.Username', '@item.User?.Password')">
                                            <img src="~/images/edit.png" />
                                        </button>
                                    </div>
                                </td>
                            }
                        </tr>
                    }
                }
            }
           
        </tbody>
    </table>
</div>


<!--Add New User-->

<div class="modal fade general-modal" id="addUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">

            <img src="~/images/coffe-logo-light.png" class="add-user-modal-img general-coffee-img-bottom" />
            <div class="modal-header">
                <h5 class="modal-title">ADD USER</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form asp-action="AddUser" id="addUserForm" method="post">
                    <div class="row-wrapper">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">First Name</label>
                                <input class="form-control inputFirstName general-modal-input" maxlength="20" oninput="validateFirstName(this)" name="firstname" placeholder="Enter First Name" type="text" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Last Name</label>
                                <input class="form-control inputLastName general-modal-input" maxlength="20" oninput="validateLastName(this)" name="lastname" placeholder="Enter Last Name" type="text" required />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Email</label>
                                <input class="form-control inputEmail general-modal-input" name="email" maxlength="30" onchange="validateEmailChange(this)" oninput="validateEmail(this)" placeholder="Enter Email Address" type="email" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Cellphone No.</label>
                                <input class="form-control inputCellphone general-modal-input" maxlength="11" oninput="validateCellNumber(this)" name="cellnumber" placeholder="Enter Cellphone Number" type="text" required />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Username</label>
                                <input class="form-control inputUsername general-modal-input" maxlength="20" oninput="validateUsername(this)" name="username" placeholder="Enter Username" type="text" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Password</label>            
                                <div class="password-toggle-user">
                                    <input class="form-control inputPassword general-modal-input" maxlength="20" name="password" placeholder="Enter Password" type="password" required />
                                    <img src="~/images/hide.png" class="eyeImage" onclick="togglePasswordVisibilityUser()" />
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 d-block mx-auto">
                                <label class="control-label general-modal-label">Role</label><br />
                                <input class="form-control general-modal-input" value="Cashier" readonly />

                           </div>
                           
                        </div>
                    </div>
                 
                                     
                    <br />
                    <div class="form-group">
                        <button type="button" class="d-block mx-auto addUserSubmit general-modal-button">ADD</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Update New User-->

<div class="modal fade general-modal" id="updateUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <img src="~/images/coffe-logo-light.png" class="update-user-modal-img general-coffee-img-top" />
            <div class="modal-header">
                <h5 class="modal-title">UPDATE USER</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form asp-action="UpdateUser" id="updateUserForm" method="post">

                    <input class="inputUserId" name="userid" hidden />
                    <div class="row-wrapper">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">First Name</label>
                                <input class="form-control inputFirstName general-modal-input" maxlength="20" oninput="validateFirstName(this)" name="firstname" placeholder="Enter First Name" type="text" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Last Name</label>
                                <input class="form-control inputLastName general-modal-input" maxlength="20" oninput="validateLastName(this)" name="lastname" placeholder="Enter Last Name" type="text" required />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Email</label>
                                <input class="form-control inputEmail general-modal-input" maxlength="30" onchange="validateEmailChange(this)" oninput="validateEmail(this)" name="email" placeholder="Enter Email Address" type="email" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Cellphone No.</label>
                                <input class="form-control inputCellphone general-modal-input" maxlength="11" oninput="validateCellNumber(this)" name="cellnumber" placeholder="Enter Cellphone Number" type="text" required />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Username</label>
                                <input class="form-control inputUsername general-modal-input" maxlength="20" oninput="validateUsername(this)" name="username" placeholder="Enter Username" type="text" required />
                            </div>

                            <div class="col-md-6">
                                <label class="control-label general-modal-label">Password</label>
                                
                                <div class="password-toggle-user">
                                    <input class="form-control inputPassword general-modal-input" maxlength="20" name="password" placeholder="Enter Password" type="password" required />
                                    <img src="~/images/hide.png" class="eyeImage" onclick="togglePasswordVisibilityUser()" />
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 d-block mx-auto">
                                <label class="control-label general-modal-label">Role</label><br />
                                <input class="form-control general-modal-input" value="Cashier" readonly />
                            </div>
                        </div>
                    </div>
                    

                    <br />
                    <div class="form-group">
                        <button type="button" class="d-block mx-auto updateUserSubmit general-modal-button">UPDATE</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--User Details-->
<div class="modal fade general-modal" id="detailsUserModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <img src="~/images/coffe-logo-light.png" class="detail-user-modal-img general-coffee-img-bottom" />
            <div class="modal-header">
                <h5 class="modal-title">USER DETAILS</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">              
                    <div class="details-wrapper">
                            
                        <div class="detail-info">
                            <div class="form-group">
                                <label class="control-label general-modal-label">Email</label>
                                <input class="form-control detailEmail general-modal-input" readonly/>
                            </div>

                            <div class="form-group">
                                <label class="control-label general-modal-label">Cellphone Number</label>
                                <input class="form-control detailCellNum general-modal-input" readonly/>
                            </div>
                        </div>
                            

                        <div class="form-group">
                            <label class="control-label general-modal-label">Username</label>
                            <input class="form-control detailUsername general-modal-input" readonly/>
                        </div>

                        <div class="form-group"">
                            <label class="control-label general-modal-label">Password</label>
                            <input class="form-control detailPassword general-modal-input" readonly />
                        </div>
                            
                    </div>                                             
               
                    <div class="form-group">
                        <button type="button" data-dismiss="modal" class="d-block mx-auto detailUserBack general-modal-button">BACK</button>
                    </div>
            </div>
        </div>
    </div>
</div>


@if (TempData["SuccessArchived"] != null)
{
    <script>
        Swal.fire({
            text: "User Deactivated",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}
@if (TempData["NoChanges"] != null)
{
    <script>
        Swal.fire({
            text: "No changes have been made",
            icon: "info",
            showConfirmButton: false,
            timer: 2000
        });
    </script>
}
@if (TempData["SuccessUnarchived"] != null)
{
    <script>
        Swal.fire({
            text: "User Activated",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}

@if (TempData["AddUser"] != null)
{
    <script>
        Swal.fire({
            text: "New User Added",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });


    </script>

}
@if (TempData["UpdateUser"] != null)
{
    <script>
        Swal.fire({
            text: "User Updated",
            icon: "success",
            showConfirmButton: false,
            timer: 2000
        });
    </script>

}
@if (TempData["Exist"] != null)
{
    <script>
        Swal.fire({
            text: "Username already exist",
            icon: "error",
            showConfirmButton: false,
            timer: 2000
        });
    </script>

}